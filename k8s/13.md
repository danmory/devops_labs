# StatefulSet

## State

Output of ``kubectl get po,sts,svc,pvc``:

![out](images/ss-get-all.png)

## Logs

Logs of replicas:

![out](images/ss-cat.png)

Totally, there are 18 logs for first replica, 49 logs for second replica.

One of replicas has more log entries because:

1. Each replica in StatefulSet has its own volume
2. Load Balancer distributed requests not equally between these replicas.

## Ordering

For our app the ordering is unnecessary because each replica is independent from others, i.e,
it will work even if other replicas fall or even if they do not exist.

We can start the pods in parallel by adding *podManagementPolicy: "Parallel"* to spec.

Result:

![out](images/ss-parallel.png)

## With GO application

Output of ``kubectl get po,sts,svc,pvc``:

![out](images/ss-go-get-all.png)

Logs of replicas:

![out](images/ss-go-log-1.png)

![out](images/ss-go-log-2.png)

![out](images/ss-go-log-count.png)

## Update strategies

Based on <https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#update-strategies>

There are two types of update strategies:

1. OnDelete

2. RollingUpdate

OnDelete strategy requires manual deletion of the pods to trigger the update
while RollingUpdate(set by default) strategy will do it automatically.

RollingUpdate strategy has sub-strategy: partitioned RollingUpdate when not all
podes will be updated(based on ordinal).
